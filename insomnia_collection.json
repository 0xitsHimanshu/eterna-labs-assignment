{
  "_type": "export",
  "__export_format": 4,
  "__export_date": "2024-01-01T00:00:00.000Z",
  "__export_source": "insomnia.desktop.app:v2023.5.8",
  "resources": [
    {
      "_id": "req_execute_order",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "1. Execute Order",
      "description": "**Step 1: Submit Order**\n\nSubmit a new order for execution. This endpoint:\n- Validates the order request\n- Creates an order record in the database\n- Adds the order to the execution queue\n- Returns an `orderId` and `websocketUrl` for live updates\n\n**Response:**\n- `orderId`: Unique identifier for tracking the order\n- `websocketUrl`: WebSocket endpoint URL for real-time status updates\n- `status`: Initial status (always 'pending')\n\n**After submitting:** Copy the `orderId` from the response - you'll need it for status checks and WebSocket connections.",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": 100,\n  \"userId\": \"user-123\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 1000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\n\n// Test: Status code is 201\nif (insomnia.response.statusCode !== 201) {\n  throw new Error(`Expected status 201, got ${insomnia.response.statusCode}`);\n}\n\n// Test: Response has required fields\nif (!response.orderId || !response.websocketUrl || !response.status) {\n  throw new Error('Missing required fields in response');\n}\n\n// Test: Initial status is 'pending'\nif (response.status !== 'pending') {\n  throw new Error(`Expected status 'pending', got '${response.status}'`);\n}\n\n// Store orderId for subsequent requests\ninsomnia.environment.set('order_id', response.orderId);\nconsole.log('Order created successfully:', response.orderId);",
      "_type": "request"
    },
    {
      "_id": "req_get_order",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/{{ _.order_id }}",
      "name": "2. Get Order Status",
      "description": "**Step 2: Check Order Status**\n\nRetrieve the current status of an order using its `orderId`.\n\n**Status Values:**\n- `pending`: Order received and queued\n- `routing`: Comparing DEX prices (Raydium vs Meteora)\n- `building`: Creating transaction for selected DEX\n- `submitted`: Transaction sent to network\n- `confirmed`: Transaction successful (includes `txHash` and `executedPrice`)\n- `failed`: Execution failed (includes `errorMessage`)\n\n**Use this endpoint:**\n- To poll for order status updates\n- As a fallback if WebSocket connection fails\n- To retrieve order details after completion",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 2000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\n\n// Test: Status code is 200\nif (insomnia.response.statusCode !== 200) {\n  throw new Error(`Expected status 200, got ${insomnia.response.statusCode}`);\n}\n\n// Test: Response contains order details\nif (!response.orderId || !response.tokenIn || !response.tokenOut || \n    !response.amountIn || !response.status) {\n  throw new Error('Missing required order fields');\n}\n\n// Test: Status is valid order status\nconst validStatuses = ['pending', 'routing', 'building', 'submitted', 'confirmed', 'failed'];\nif (!validStatuses.includes(response.status)) {\n  throw new Error(`Invalid status: ${response.status}`);\n}\n\nconsole.log('Order status retrieved:', response.status);",
      "_type": "request"
    },
    {
      "_id": "req_queue_metrics",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/metrics/queue",
      "name": "3. Get Queue Metrics",
      "description": "**Monitor Queue Health**\n\nGet current queue metrics to monitor system health.\n\n**Response Fields:**\n- `waiting`: Number of orders waiting in queue\n- `active`: Number of orders currently being processed\n- `completed`: Total number of completed orders\n- `failed`: Total number of failed orders\n\n**Use this endpoint:**\n- To monitor system load\n- To check if orders are being processed\n- For debugging and performance monitoring",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 3000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\n\n// Test 1: Status code is 200\nif (insomnia.response.statusCode !== 200) {\n  throw new Error(`Expected status 200, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Response has queue metrics structure\nif (!response.waiting !== undefined || !response.active !== undefined || \n    !response.completed !== undefined || !response.failed !== undefined) {\n  throw new Error('Missing required queue metrics fields');\n}\n\n// Test 3: Queue metrics are non-negative numbers\nif (response.waiting < 0 || response.active < 0 || \n    response.completed < 0 || response.failed < 0) {\n  throw new Error('Queue metrics must be non-negative');\n}\n\nconsole.log('Queue metrics test passed:', response);",
      "_type": "request"
    },
    {
      "_id": "req_test_1",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 1: Order Submission - Valid Request",
      "description": "**Test: Order Submission Validation**\n\nTests:\n- Valid order submission returns 201\n- Response contains orderId, websocketUrl, status\n- orderId is valid UUID\n- Initial status is 'pending'",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": 100,\n  \"userId\": \"test-user-1\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 4000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\n\n// Test 1: Status code is 201\nif (insomnia.response.statusCode !== 201) {\n  throw new Error(`Expected status 201, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Response has required fields\nif (!response.orderId || !response.websocketUrl || !response.status) {\n  throw new Error('Missing required fields in response');\n}\n\n// Test 3: Initial status is 'pending'\nif (response.status !== 'pending') {\n  throw new Error(`Expected status 'pending', got '${response.status}'`);\n}\n\n// Test 4: orderId is valid UUID format\nconst uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\nif (!uuidRegex.test(response.orderId)) {\n  throw new Error(`Invalid UUID format: ${response.orderId}`);\n}\n\n// Test 5: websocketUrl contains orderId\nif (!response.websocketUrl.includes(response.orderId)) {\n  throw new Error('websocketUrl does not contain orderId');\n}\n\n// Store orderId for subsequent tests\ninsomnia.environment.set('test_order_id_1', response.orderId);\nconsole.log('Order submission test passed:', response.orderId);",
      "_type": "request"
    },
    {
      "_id": "req_test_2",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 2: Order Submission - Invalid Request (Negative Amount)",
      "description": "**Test: Invalid Order Validation**\n\nTests:\n- Negative amountIn returns 400\n- Error message indicates validation failure",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": -100,\n  \"userId\": \"test-user\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 5000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// Test 1: Status code is 400 for invalid request\nif (insomnia.response.statusCode !== 400) {\n  throw new Error(`Expected status 400, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Error message indicates validation failure\nconst response = await insomnia.response.json();\nif (!response.error || !response.message) {\n  throw new Error('Missing error fields in response');\n}\n\nif (!response.message.toLowerCase().includes('amountin')) {\n  throw new Error('Error message should mention amountIn');\n}\n\nconsole.log('Invalid request test passed');",
      "_type": "request"
    },
    {
      "_id": "req_test_3",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 3: Order Submission - Missing Required Fields",
      "description": "**Test: Missing Required Fields**\n\nTests:\n- Missing required fields returns 400\n- Error message indicates what's missing",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 6000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// Test 1: Status code is 400 for missing fields\nif (insomnia.response.statusCode !== 400) {\n  throw new Error(`Expected status 400, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Error message indicates missing required fields\nconst response = await insomnia.response.json();\nif (!response.error || !response.message) {\n  throw new Error('Missing error fields in response');\n}\n\nconsole.log('Missing fields test passed');",
      "_type": "request"
    },
    {
      "_id": "req_test_4",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/{{ _.order_id }}",
      "name": "Test 4: Get Order Status - Valid Order",
      "description": "**Test: Get Order Status**\n\nTests:\n- Valid orderId returns 200\n- Response contains all order fields\n- Status is valid order status value\n- amountIn is positive",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 7000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\n\n// Test 1: Status code is 200\nif (insomnia.response.statusCode !== 200) {\n  throw new Error(`Expected status 200, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Response contains order details\nconst requiredFields = ['orderId', 'tokenIn', 'tokenOut', 'amountIn', 'status', 'createdAt', 'updatedAt'];\nrequiredFields.forEach(field => {\n  if (!(field in response)) {\n    throw new Error(`Missing required field: ${field}`);\n  }\n});\n\n// Test 3: Status is valid order status\nconst validStatuses = ['pending', 'routing', 'building', 'submitted', 'confirmed', 'failed'];\nif (!validStatuses.includes(response.status)) {\n  throw new Error(`Invalid status: ${response.status}`);\n}\n\n// Test 4: amountIn is positive number\nif (typeof response.amountIn !== 'number' || response.amountIn <= 0) {\n  throw new Error(`Invalid amountIn: ${response.amountIn}`);\n}\n\nconsole.log('Get order status test passed:', response.status);",
      "_type": "request"
    },
    {
      "_id": "req_test_5",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/00000000-0000-0000-0000-000000000000",
      "name": "Test 5: Get Order Status - Order Not Found",
      "description": "**Test: Order Not Found**\n\nTests:\n- Non-existent orderId returns 404\n- Error message indicates order not found",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 8000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// Test 1: Status code is 404 for non-existent order\nif (insomnia.response.statusCode !== 404) {\n  throw new Error(`Expected status 404, got ${insomnia.response.statusCode}`);\n}\n\n// Test 2: Error message indicates order not found\nconst response = await insomnia.response.json();\nif (!response.error || !response.message) {\n  throw new Error('Missing error fields in response');\n}\n\nif (!response.message.toLowerCase().includes('not found')) {\n  throw new Error('Error message should indicate order not found');\n}\n\nconsole.log('Order not found test passed');",
      "_type": "request"
    },
    {
      "_id": "req_test_6",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 6: Order Status Progression - Routing Logic",
      "description": "**Test: Routing Logic**\n\nTests:\n- Order progresses from pending to routing\n- DEX is selected (raydium or meteora)\n- amountOut is calculated after routing\n- Order status progression works correctly",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": 50,\n  \"userId\": \"test-routing\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 9000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\nconst orderId = response.orderId;\n\n// Wait for order to progress through routing\nawait new Promise(resolve => setTimeout(resolve, 2000));\n\n// Check order status\nconst statusResponse = await insomnia.sendRequest({\n  url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n  method: 'GET'\n});\n\nconst order = await statusResponse.json();\n\n// Test: Order progressed from pending\nif (order.status === 'pending') {\n  throw new Error('Order still in pending status');\n}\n\n// Test: If order reached building stage, DEX should be selected\nif (['building', 'submitted', 'confirmed'].includes(order.status)) {\n  if (!order.dexUsed) {\n    throw new Error('DEX not selected after routing');\n  }\n  \n  if (!['raydium', 'meteora'].includes(order.dexUsed)) {\n    throw new Error(`Invalid DEX: ${order.dexUsed}`);\n  }\n  \n  if (!order.amountOut || order.amountOut <= 0) {\n    throw new Error('amountOut not calculated after routing');\n  }\n}\n\nconsole.log('Routing logic test passed:', order.status, order.dexUsed);",
      "_type": "request"
    },
    {
      "_id": "req_test_7",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 7: Different Token Pairs - Routing Selection",
      "description": "**Test: Different Token Pairs**\n\nTests:\n- Order with different token pair (ETH/USDT) works\n- DEX routing logic applies to different pairs\n- Token pair values are preserved",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"ETH\",\n  \"tokenOut\": \"USDT\",\n  \"amountIn\": 10,\n  \"userId\": \"test-token-pair\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 10000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\nconst orderId = response.orderId;\n\n// Wait for routing to complete\nawait new Promise(resolve => setTimeout(resolve, 3000));\n\n// Check order status\nconst statusResponse = await insomnia.sendRequest({\n  url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n  method: 'GET'\n});\n\nconst order = await statusResponse.json();\n\n// Test: Token pair preserved\nif (order.tokenIn !== 'ETH' || order.tokenOut !== 'USDT') {\n  throw new Error('Token pair not preserved');\n}\n\n// Test: DEX routing works for different token pairs\nif (['building', 'submitted', 'confirmed'].includes(order.status)) {\n  if (!order.dexUsed || !['raydium', 'meteora'].includes(order.dexUsed)) {\n    throw new Error('DEX routing failed for different token pair');\n  }\n}\n\nconsole.log('Different token pairs test passed:', order.dexUsed);",
      "_type": "request"
    },
    {
      "_id": "req_test_8",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 8: Order Confirmation - Executed Price and TX Hash",
      "description": "**Test: Order Confirmation**\n\nTests:\n- Order reaches confirmed status\n- Transaction hash is present\n- Executed price is calculated\n- Amount out is calculated correctly",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": 25,\n  \"userId\": \"test-confirmation\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 11000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\nconst orderId = response.orderId;\n\n// Poll for order completion (up to 10 seconds)\nlet attempts = 0;\nconst maxAttempts = 20;\nlet order = null;\n\nwhile (attempts < maxAttempts) {\n  await new Promise(resolve => setTimeout(resolve, 500));\n  \n  const statusResponse = await insomnia.sendRequest({\n    url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n    method: 'GET'\n  });\n  \n  order = await statusResponse.json();\n  \n  if (order.status === 'confirmed' || order.status === 'failed') {\n    break;\n  }\n  \n  attempts++;\n}\n\nif (!order) {\n  throw new Error('Failed to retrieve order status');\n}\n\nif (order.status === 'confirmed') {\n  // Test: Transaction hash present\n  if (!order.txHash || typeof order.txHash !== 'string') {\n    throw new Error('Transaction hash missing or invalid');\n  }\n  \n  // Test: Executed price present\n  if (!order.executedPrice || typeof order.executedPrice !== 'number' || order.executedPrice <= 0) {\n    throw new Error('Executed price missing or invalid');\n  }\n  \n  // Test: Amount out calculated\n  if (!order.amountOut || typeof order.amountOut !== 'number' || order.amountOut <= 0) {\n    throw new Error('Amount out missing or invalid');\n  }\n  \n  // Test: Amount out is reasonable\n  if (order.amountOut > order.amountIn * 2) {\n    throw new Error('Amount out seems unreasonably high');\n  }\n} else if (order.status === 'failed') {\n  if (!order.errorMessage) {\n    throw new Error('Failed order should have errorMessage');\n  }\n} else {\n  throw new Error(`Order did not complete. Status: ${order.status}`);\n}\n\nconsole.log('Order confirmation test passed:', order.status);",
      "_type": "request"
    },
    {
      "_id": "req_test_9",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/metrics/queue",
      "name": "Test 9: Queue Metrics - After Multiple Orders",
      "description": "**Test: Queue Metrics with Multiple Orders**\n\nTests:\n- Queue metrics reflect multiple orders\n- Active orders respect concurrency limit (max 10)\n- Total orders tracked correctly",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 12000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// First, create multiple orders\nconst orderPromises = [];\nfor (let i = 0; i < 3; i++) {\n  orderPromises.push(\n    insomnia.sendRequest({\n      url: `${insomnia.environment.get('base_url')}/api/orders/execute`,\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        tokenIn: 'SOL',\n        tokenOut: 'USDC',\n        amountIn: 10 + i,\n        userId: `test-queue-${i}`\n      })\n    })\n  );\n}\n\nawait Promise.all(orderPromises);\n\n// Wait for orders to be processed\nawait new Promise(resolve => setTimeout(resolve, 2000));\n\n// Check queue metrics\nconst response = await insomnia.response.json();\n\n// Test: Queue metrics reflect multiple orders\nconst total = response.waiting + response.active + response.completed;\nif (total < 3) {\n  throw new Error(`Expected at least 3 orders, got ${total}`);\n}\n\n// Test: Active orders are within concurrency limit\nif (response.active > 10) {\n  throw new Error(`Active orders exceed concurrency limit: ${response.active}`);\n}\n\n// Test: Total orders tracked correctly\nconst totalTracked = response.waiting + response.active + response.completed + response.failed;\nif (totalTracked < 3) {\n  throw new Error(`Total orders tracked incorrectly: ${totalTracked}`);\n}\n\nconsole.log('Queue metrics test passed:', response);",
      "_type": "request"
    },
    {
      "_id": "req_test_10",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/metrics/queue",
      "name": "Test 10: Queue Behavior - Concurrent Order Submission",
      "description": "**Test: Concurrent Order Submission**\n\nTests:\n- Multiple orders can be submitted concurrently\n- All orders get unique orderIds\n- Queue handles concurrent submissions correctly",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 13000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// Submit concurrent orders\nconst concurrentOrders = 5;\nconst orderPromises = [];\n\nfor (let i = 0; i < concurrentOrders; i++) {\n  orderPromises.push(\n    insomnia.sendRequest({\n      url: `${insomnia.environment.get('base_url')}/api/orders/execute`,\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        tokenIn: 'SOL',\n        tokenOut: 'USDC',\n        amountIn: 20 + i,\n        userId: `concurrent-test-${i}`\n      })\n    })\n  );\n}\n\nconst results = await Promise.all(orderPromises);\nconst orderIds = results.map(r => r.json().orderId);\n\n// Test: All concurrent orders submitted successfully\nconst successful = results.filter(r => r.statusCode === 201).length;\nif (successful !== concurrentOrders) {\n  throw new Error(`Expected ${concurrentOrders} successful orders, got ${successful}`);\n}\n\n// Test: All orders have unique orderIds\nconst uniqueIds = new Set(orderIds);\nif (uniqueIds.size !== concurrentOrders) {\n  throw new Error(`Expected ${concurrentOrders} unique orderIds, got ${uniqueIds.size}`);\n}\n\n// Check queue metrics\nawait new Promise(resolve => setTimeout(resolve, 1000));\n\nconst metricsResponse = await insomnia.sendRequest({\n  url: `${insomnia.environment.get('base_url')}/api/orders/metrics/queue`,\n  method: 'GET'\n});\n\nconst metrics = await metricsResponse.json();\n\n// Test: Queue handles concurrent submissions\nconst totalInQueue = metrics.waiting + metrics.active;\nif (totalInQueue + metrics.completed < concurrentOrders) {\n  throw new Error('Queue did not handle concurrent submissions correctly');\n}\n\nconsole.log('Concurrent submission test passed:', orderIds.length);",
      "_type": "request"
    },
    {
      "_id": "req_test_11",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/{{ _.order_id }}",
      "name": "Test 11: Order Status Progression - Complete Lifecycle",
      "description": "**Test: Complete Order Lifecycle**\n\nTests:\n- Order progresses through all expected statuses\n- Status progression includes pending → routing → building → submitted → confirmed\n- Confirmed orders have all required fields",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 14000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// First create an order\nconst createResponse = await insomnia.sendRequest({\n  url: `${insomnia.environment.get('base_url')}/api/orders/execute`,\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    tokenIn: 'SOL',\n    tokenOut: 'USDC',\n    amountIn: 30,\n    userId: 'lifecycle-test'\n  })\n});\n\nconst orderId = (await createResponse.json()).orderId;\nconst statusProgression = [];\n\n// Poll for status changes\nlet attempts = 0;\nconst maxAttempts = 30;\nlet order = null;\n\nwhile (attempts < maxAttempts) {\n  await new Promise(resolve => setTimeout(resolve, 500));\n  \n  const statusResponse = await insomnia.sendRequest({\n    url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n    method: 'GET'\n  });\n  \n  order = await statusResponse.json();\n  \n  if (!statusProgression.includes(order.status)) {\n    statusProgression.push(order.status);\n  }\n  \n  if (order.status === 'confirmed' || order.status === 'failed') {\n    break;\n  }\n  \n  attempts++;\n}\n\nif (!order) {\n  throw new Error('Failed to retrieve order');\n}\n\n// Test: Order completed lifecycle\nif (!['confirmed', 'failed'].includes(order.status)) {\n  throw new Error(`Order did not complete. Status: ${order.status}`);\n}\n\n// Test: Status progression includes expected stages\nif (!statusProgression.includes('pending')) {\n  throw new Error('Status progression missing pending stage');\n}\n\nif (!statusProgression.includes('routing')) {\n  throw new Error('Status progression missing routing stage');\n}\n\n// Test: Confirmed order has all required fields\nif (order.status === 'confirmed') {\n  const requiredFields = ['txHash', 'executedPrice', 'dexUsed', 'amountOut'];\n  requiredFields.forEach(field => {\n    if (!(field in order)) {\n      throw new Error(`Missing required field in confirmed order: ${field}`);\n    }\n  });\n}\n\nconsole.log('Order lifecycle test passed. Progression:', statusProgression);",
      "_type": "request"
    },
    {
      "_id": "req_test_12",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/metrics/queue",
      "name": "Test 12: Different Amounts - Routing Consistency",
      "description": "**Test: Different Amounts**\n\nTests:\n- Orders with different amounts all process correctly\n- Amount out is proportional to amount in\n- Routing logic works consistently across amounts",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 15000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// Create orders with different amounts\nconst amounts = [10, 50, 100, 500];\nconst orderPromises = amounts.map(amount =>\n  insomnia.sendRequest({\n    url: `${insomnia.environment.get('base_url')}/api/orders/execute`,\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      tokenIn: 'SOL',\n      tokenOut: 'USDC',\n      amountIn: amount,\n      userId: `amount-test-${amount}`\n    })\n  })\n);\n\nconst createResults = await Promise.all(orderPromises);\nconst orderIds = createResults.map(r => r.json().orderId);\n\n// Wait for orders to process\nawait new Promise(resolve => setTimeout(resolve, 5000));\n\n// Check order details\nconst orderDetailsPromises = orderIds.map(orderId =>\n  insomnia.sendRequest({\n    url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n    method: 'GET'\n  })\n);\n\nconst orderDetailsResults = await Promise.all(orderDetailsPromises);\nconst orderDetails = await Promise.all(orderDetailsResults.map(r => r.json()));\n\n// Test: All orders processed regardless of amount\nconst processed = orderDetails.filter(o => \n  ['building', 'submitted', 'confirmed'].includes(o.status)\n).length;\n\nif (processed < amounts.length - 1) {\n  throw new Error(`Expected at least ${amounts.length - 1} processed orders, got ${processed}`);\n}\n\n// Test: Amount out proportional to amount in\norderDetails.forEach((order, idx) => {\n  if (order.amountOut) {\n    const ratio = order.amountOut / order.amountIn;\n    if (ratio <= 0 || ratio >= 2) {\n      throw new Error(`Invalid amount ratio for order ${order.orderId}: ${ratio}`);\n    }\n  }\n});\n\nconsole.log('Different amounts test passed:', orderDetails.map(o => o.status));",
      "_type": "request"
    },
    {
      "_id": "req_test_13",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 13: WebSocket Connection - Valid OrderId (Manual)",
      "description": "**Test: WebSocket Connection with Valid OrderId**\n\n**Note:** Insomnia does not support WebSocket testing in automated tests. Use a WebSocket client for manual testing.\n\n**Manual Test Steps:**\n1. Execute an order first to get orderId\n2. Connect to WebSocket URL: `ws://localhost:3000/api/orders/execute?orderId=YOUR_ORDER_ID`\n3. Verify connection opens successfully\n4. Verify status updates are received in real-time\n5. Verify connection closes gracefully when order completes\n\n**Expected Behavior:**\n- Connection established successfully\n- Status updates received: routing → building → submitted → confirmed\n- Each update contains orderId, status, and relevant fields\n- Connection closes when status is 'confirmed' or 'failed'\n\n**JavaScript Example:**\n```javascript\nconst orderId = 'your-order-id-here';\nconst ws = new WebSocket(`ws://localhost:3000/api/orders/execute?orderId=${orderId}`);\n\nws.onopen = () => console.log('WebSocket connected');\nws.onmessage = (event) => {\n  const update = JSON.parse(event.data);\n  console.log('Status:', update.status, update);\n  if (update.status === 'confirmed' || update.status === 'failed') {\n    ws.close();\n  }\n};\nws.onerror = (error) => console.error('WebSocket error:', error);\nws.onclose = () => console.log('WebSocket closed');\n```",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 16000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// WebSocket tests require manual execution in Insomnia\n// Use the JavaScript example in the description to test WebSocket connections\nconsole.log('WebSocket test requires manual execution. See description for instructions.');",
      "_type": "request"
    },
    {
      "_id": "req_test_14",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 14: WebSocket Connection - Missing OrderId (Manual)",
      "description": "**Test: WebSocket Connection Without OrderId**\n\n**Manual Test Steps:**\n1. Attempt to connect to WebSocket without orderId query parameter\n2. Verify connection is rejected\n3. Verify close code is 1008 (Policy Violation)\n4. Verify close reason indicates missing orderId\n\n**Expected Behavior:**\n- Connection rejected immediately\n- Close code: 1008\n- Close reason: 'Missing orderId'\n\n**JavaScript Example:**\n```javascript\nconst ws = new WebSocket('ws://localhost:3000/api/orders/execute');\nws.onclose = (event) => {\n  console.log('Close code:', event.code); // Should be 1008\n  console.log('Close reason:', event.reason); // Should mention missing orderId\n};\nws.onerror = (error) => console.error('WebSocket error:', error);\n```",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 17000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// WebSocket rejection test requires manual execution\nconsole.log('WebSocket rejection test requires manual execution. See description for instructions.');",
      "_type": "request"
    },
    {
      "_id": "req_test_15",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/{{ _.order_id }}",
      "name": "Test 15: WebSocket Status Update Progression (Manual)",
      "description": "**Test: WebSocket Status Update Progression**\n\n**Manual Test Steps:**\n1. Create an order and connect to WebSocket\n2. Track all received status updates\n3. Verify status progression: pending → routing → building → submitted → confirmed\n4. Verify each update contains orderId and status\n5. Verify dexUsed appears after routing stage\n6. Verify txHash and executedPrice appear on confirmed status\n\n**Expected Status Progression:**\n- `routing`: Contains orderId, status, message\n- `building`: Contains orderId, status, message, dexUsed\n- `submitted`: Contains orderId, status, message, dexUsed\n- `confirmed`: Contains orderId, status, message, dexUsed, txHash, executedPrice\n\n**Message Format Validation:**\n- All messages are valid JSON\n- All messages contain orderId matching the connected order\n- Status values are valid order statuses\n\n**JavaScript Example:**\n```javascript\nconst orderId = 'your-order-id-here';\nconst ws = new WebSocket(`ws://localhost:3000/api/orders/execute?orderId=${orderId}`);\nconst statuses = [];\n\nws.onmessage = (event) => {\n  const update = JSON.parse(event.data);\n  statuses.push(update.status);\n  console.log('Received:', update);\n  \n  // Validate message format\n  if (!update.orderId || !update.status) {\n    console.error('Invalid message format');\n  }\n  \n  if (update.status === 'confirmed') {\n    if (!update.txHash || !update.executedPrice) {\n      console.error('Confirmed status missing required fields');\n    }\n    ws.close();\n  }\n};\n\nws.onclose = () => {\n  console.log('Status progression:', statuses);\n  // Should include: routing, building, submitted, confirmed\n};\n```",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": 18000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "// WebSocket status progression test requires manual execution\n// Use the JavaScript example in the description to test WebSocket status updates\nconsole.log('WebSocket status progression test requires manual execution. See description for instructions.');",
      "_type": "request"
    },
    {
      "_id": "req_test_16",
      "parentId": "fld_orders",
      "modified": 1704067200000,
      "created": 1704067200000,
      "url": "{{ _.base_url }}/api/orders/execute",
      "name": "Test 16: DEX Selection Logic - Best Price Selection",
      "description": "**Test: DEX Selection Logic**\n\nTests:\n- System selects DEX with better price (higher amountOut)\n- Both Raydium and Meteora quotes are fetched\n- Best DEX is selected based on amountOut comparison",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"tokenIn\": \"SOL\",\n  \"tokenOut\": \"USDC\",\n  \"amountIn\": 100,\n  \"userId\": \"test-dex-selection\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": 19000000000000,
      "isPrivate": false,
      "settingStoreCookies": true,
      "settingSendCookies": true,
      "settingDisableRenderRequestBody": false,
      "settingEncodeUrl": true,
      "settingRebuildPath": true,
      "settingFollowRedirects": "global",
      "tests": "const response = await insomnia.response.json();\nconst orderId = response.orderId;\n\n// Wait for routing to complete\nawait new Promise(resolve => setTimeout(resolve, 3000));\n\n// Check order status\nconst statusResponse = await insomnia.sendRequest({\n  url: `${insomnia.environment.get('base_url')}/api/orders/${orderId}`,\n  method: 'GET'\n});\n\nconst order = await statusResponse.json();\n\n// Test: DEX is selected after routing\nif (['building', 'submitted', 'confirmed'].includes(order.status)) {\n  if (!order.dexUsed) {\n    throw new Error('DEX not selected');\n  }\n  \n  if (!['raydium', 'meteora'].includes(order.dexUsed)) {\n    throw new Error(`Invalid DEX selected: ${order.dexUsed}`);\n  }\n  \n  // Test: amountOut is calculated (indicates price comparison happened)\n  if (!order.amountOut || order.amountOut <= 0) {\n    throw new Error('amountOut not calculated after DEX selection');\n  }\n  \n  // Test: amountOut is reasonable (less than amountIn * 2)\n  if (order.amountOut > order.amountIn * 2) {\n    throw new Error(`Unreasonable amountOut: ${order.amountOut} for amountIn: ${order.amountIn}`);\n  }\n}\n\nconsole.log('DEX selection test passed:', order.dexUsed, order.amountOut);",
      "_type": "request"
    },
    {
      "_id": "fld_orders",
      "parentId": "wrk_main",
      "modified": 1704067200000,
      "created": 1704067200000,
      "name": "Orders",
      "description": "Order execution endpoints. Execute in order: 1. Execute Order → 2. Get Order Status → 3. Get Queue Metrics",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": 1000000000000,
      "_type": "request_group"
    },
    {
      "_id": "wrk_main",
      "parentId": null,
      "modified": 1704067200000,
      "created": 1704067200000,
      "name": "Order Execution Engine",
      "description": "Complete API collection for Order Execution Engine with DEX routing and WebSocket status updates.",
      "scope": "collection",
      "_type": "workspace"
    },
    {
      "_id": "env_base",
      "parentId": "wrk_main",
      "modified": 1704067200000,
      "created": 1704067200000,
      "name": "Base Environment",
      "data": {
        "base_url": "http://localhost:3000",
        "order_id": ""
      },
      "dataPropertyOrder": {
        "&": ["base_url", "order_id"]
      },
      "color": null,
      "isPrivate": false,
      "metaSortKey": 1704067200000,
      "_type": "environment"
    }
  ]
}
